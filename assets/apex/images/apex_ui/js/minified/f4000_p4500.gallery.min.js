window.componentGallery={},function(a,b,c,d,e,f){"use strict";function g(a){var b,c=a.split(":"),d=y[x[c[0]]];if(d&&(b=d[c[1]]),!b)throw"Invalid component data key";return b}function h(a,c,d){var e,f=b.isPageReadOnly();e=z[d.type],f||(e+=" is-draggable"),a.markup("<li").attr("class",e).optionalAttr("aria-grabbed",f?null:"false").attr("data-component",d.type+":"+c).markup("><span class='a-Icon ").attr(d.iconClass).markup("'></span><span class='a-Gallery-componentName'>").content(d.title).markup("</span></li>")}function i(a,b,c){var f=d.htmlBuilder();return b=b||"",/^\s</.test(b)||(b="<p>"+b+"</p>"),f.markup("<span class='tt-title'>").content(a).markup("</span>").markup(b),c||f.markup("<p>").content(e.formatMessageNoEscape("PD.GAL.NOT_SUPPORTED",v)).markup("</p>"),f.toString()}function j(){var a,d,f,g,h,j=b.getComponentType(b.COMP_TYPE.REGION).pluginType.plugins;for(a in j)if(j.hasOwnProperty(a)){if(d=j[a],d.isLegacy||"NATIVE_DATA_UPLOAD_COLUMN_MAPPING"===d.name)continue;g=-1!==c.inArray(u,d.uiTypes),h=b.getTheme().defaultTemplates["NATIVE_IR"===a?"ir":"region"],f={type:p,iconClass:window.pageDesigner.getComponentIconClass(p,a),title:g?d.title:e.formatMessage("PD.UNSUPPORTED",d.title),isSupported:g,tooltip:i(d.title,d.helpText,g),values:[{id:b.PROP.REGION_TYPE,value:a},{id:b.PROP.REGION_TEMPLATE,value:h}]},y.regions.push(f)}}function k(){var a,d,f,g,h=b.getComponentType(b.COMP_TYPE.PAGE_ITEM).pluginType.plugins;for(a in h)if(h.hasOwnProperty(a)){if(d=h[a],d.isLegacy)continue;g=-1!==c.inArray(u,d.uiTypes),f={type:q,iconClass:window.pageDesigner.getComponentIconClass(q,a),title:g?d.title:e.formatMessage("PD.UNSUPPORTED",d.title),isSupported:g,tooltip:i(d.title,d.helpText,g),values:[{id:b.PROP.ITEM_TYPE,value:a}]},y.items.push(f)}}function l(){function a(a,c,d){f={type:r,iconClass:window.pageDesigner.getComponentIconClass(r,"Y"===d?"hot":"normal"),title:a,isSupported:!0,tooltip:i(a,"",!0),values:[{id:b.PROP.BUTTON_TEMPLATE,value:c},{id:b.PROP.BUTTON_IS_HOT,value:d}]},y.buttons.push(f)}var c,d,f,g=b.getButtonTemplates();for(c in g)g.hasOwnProperty(c)&&(d=g[c],a(d.name,c,"N"),d.hasHotTemplate&&a(e.formatMessage("PD.GAL.HOT_BTN",d.name),c,"Y"))}function m(){var a=b.getComponents(b.COMP_TYPE.PAGE)[0];u=a._uiType,v=a.getProperty(b.PROP.USER_INTERFACE).getDisplayValue(),j(),k(),l(),c.each(["regions","items","buttons"],function(a,b){y[b].sort(function(a,b){return a.title.localeCompare(b.title)})}),n()}function n(){var a=c("#glv"),e=b.isPageReadOnly(),f=d.htmlBuilder();c.each(["regions","items","buttons"],function(b,d){var i,j,k=y[d],l=c("#cg-"+d+" ul").first();for(f.clear(),i=0;i<k.length;i++)j=k[i],(j.isSupported||w)&&h(f,i,j);l.html(f.toString()).iconList("refresh"),e||c("#cg-"+d+" li").draggable({addClasses:!1,appendTo:"#glv-viewport",cursor2:"default",cursorAt:{left:2,top:2},delay:10,distance:5,opacity:.9,revert:!1,helper:function(){var b=c(this),d=b.attr("data-component"),e=g(d);return a.gridlayout("makeHelper",e.type,e.iconClass,e.title,d)},connectToGridlayout:"#glv",containment:"document",zIndex:1e3,start:function(a,b){0!==c("#editor_tabs").tabs("option","active")&&c("#editor_tabs").tabs("option","active",0),apex.tooltipManager.disableTooltips()},stop:function(a,b){apex.tooltipManager.enableTooltips()}})})}function o(){c.each(["regions","items","buttons"],function(a,b){var d=c("#cg-"+b+" ul").first();y[b]=[],d.empty().iconList("refresh")})}var p="region",q="item",r="button",s="GAL_SHOW_UNSUP",t="GAL_CUR_TAB",u=null,v="",w=!1,x={region:"regions",item:"items",button:"buttons"},y={regions:[],items:[],buttons:[]},z={region:"a-Gallery-region",item:"a-Gallery-pageItem",button:"a-Gallery-button"};a.getComponentData=g,c(document).ready(function(){var a,d=!1;w="Y"===window.pageDesigner.getPreference(s);var e={menubar:!1,items:[{id:"addTo",type:"subMenu",disabled:!0,labelKey:"PD.GAL.MI.ADD2",menu:{items:[]}},{type:"toggle",labelKey:"PD.GAL.MI.SHOW_UNSUP",get:function(){return w},set:function(a){w=a,n(),window.pageDesigner.savePreference(s,w?"Y":"N")}}],beforeOpen:function(a,d){var e,f,h,i,j=c("#glv"),k=d.menuElement.menu("find","addTo"),l=d.selection;1!==l.length||b.isPageReadOnly()?k.menu.items=[]:(e=l.eq(0),i=e.attr("data-component"),f=g(i),h=function(){window.pageDesigner.glvMenuAddAction.call(this,i)},k.menu.items=window.pageDesigner.glvMakeTargetMenu(j.gridlayout("getDropTargets",f.type,"add"),h)),k.disabled=0===k.menu.items.length}};c("#cg-regions ul, #cg-items ul, #cg-buttons ul").addClass("a-Gallery").each(function(){c(this).iconList({multiple:!1,contextMenu:e,contextMenuId:"galleryMenu-"+c(this).parent().parent()[0].id})}).tooltip({items:"li",show:apex.tooltipManager.defaultShowOption(),position:{my:"left-20 top-20",at:"right bottom",collision:"flipfit"},content:function(){var a=g(c(this).attr("data-component"));return a.tooltip}}),c("#gallery-tabs").on("tabsactivate",function(a,b){c("#galleryMenuBtn").attr("data-menu","galleryMenu-"+b.newPanel[0].id),d||window.pageDesigner.savePreference(t,b.newTab.parent().children().index(b.newTab[0])),d=!1}),c("#galleryMenuBtn").attr("data-menu","galleryMenu-cg-regions"),a=parseInt(window.pageDesigner.getPreference(t),10),!isNaN(a)&&a>0&&setTimeout(function(){d=!0,c("#gallery-tabs").tabs("option","active",a)},10),c("#gallery-tabs .u-ScrollingViewport.resize").resize(function(){c(this).children(".a-IconList").resize()})}),c(document).on("modelReady",function(){m()}),c(document).on("modelCleared",function(){o()})}(window.componentGallery,pe,apex.jQuery,apex.util,apex.lang);